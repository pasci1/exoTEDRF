# ========================= BEGIN DMS CONFIG FILE =============================
#
# This is the configuration file for run_DMS.py.
#
# ===== Key Parameters =====
# Path to CRDS cache.
crds_cache_path : './crds_cache/'
# Input data file directory.
input_dir : 'DMS_uncal/'
# Input file tag.
input_filetag : 'uncal'

# ===== Stage 1 Input Files & Parameters =====
# Background model. Default model available here:
# https://jwst-docs.stsci.edu/jwst-near-infrared-imager-and-slitless-spectrograph/niriss-observing-strategies/niriss-soss-recommended-strategies
background_file : 'model_background256.npy'
# 1/f correction method; either 'scale-achromatic', 'scale-chromatic', 'solve', or 'window'.
oof_method : 'scale-achromatic'
# If oof_method is "scale-chromatic", the diffraction order to correct.
oof_order : None
# For 1/f correction; estimate of 1D or 2D timeseries for order 1 or 2 (optional).
timeseries : None
# For 1/f correction; estimate of 1D or 2D timeseries for order 2. Only necessary for oof_method is "window" (optional).
timeseries_o2 : None
# For 1/f correction; outlier pixel maps (optional).
outlier_maps : None
# For window 1/f correction; if oof_method is "window", window size will be oof_width - soss_width (optional).
oof_width : None
# For jump detection; sigma threshold for a pixel to be flagged as an outlier.
jump_threshold : 15
# For jump detection; whether to also flag outliers in the time domain.
flag_in_time : False
# For time domain jump detection; sigma threshold for a pixel to be flagged as an outlier.
time_jump_threshold : 10
# List of Stage 1 steps to skip, if any.
stage1_skip : None
# DMS Stage 1 kwargs. Format should be: {'step_name': {'kwd': value}}.
stage1_kwargs : {}

# ===== Stage 2 Input Files & Parameters =====
# For outlier detection; sigma threshold for a pixel to be flagged as an outlier, spatially.
space_outlier_threshold : 15
# For outlier detection; sigma threshold for a pixel to be flagged as an outlier, temporally.
time_outlier_threshold : 10
# If True, create a mask of the target trace orders.
generate_tracemask : True
# If True, calculate the stability of the SOSS trace over the course of the TSO using principle component analysis.
calculate_stability : True
# Number of principle components to extract. Only necessary if calculate_stability is True.
pca_components : 10
# If True, generate a smoothed estimate of the order 1 white light curve.
generate_lc : True
# Timescale on which to smooth lightcurve estimate (optional).
smoothing_scale : None
# If True, use an F277W filter exposure to create a mask of background order 0s.
generate_order0_mask : False
# Path to a processed (superbias and background subtracted) F277W exposure data frame (optional). Only necessary if
# generate_order0_mask is True.
f277w : None
# List of Stage 2 steps to skip, if any.
stage2_skip : None
# DMS Stage 2 kwargs. Format should be: {'step_name': {'kwd': value}}.
stage2_kwargs : {}

# ===== Stage 3 Input Files & Parameters =====
# Extraction method: box or atoca.
extract_method : 'box'
# Box width to extract around the trace center.
soss_width : 40
# Specprofile reference file for ATOCA (optional).
specprofile : None
# File with centroids for all three orders for box extraction (optional).
centroids : None
# Stellar effective temperature in K for wavelength calibration (optional).
st_teff : None
# Stellar log surface gravity for wavelength calibration (optional).
st_logg: None
# Stellar metallicity as [Fe/H] for wavelength calibration (optional).
st_met : None
# Planet letter designation.
planet_letter : 'b'
# If chromatic 1/f correction was performed, list of extraction-ready order 2 datafiles.
datafiles2 : None
# DMS Stage 3 kwargs. Format should be: {'step_name': {'kwd': value}}.
stage3_kwargs : {}

# ===== Other General Parameters =====
# Name tag for output file directory.
output_tag : ''
# Pipeline stages to run.
run_stages : [1, 2, 3]
# Type of exposure; either CLEAR or F277W.
exposure_type : 'CLEAR'
# Save results of each intermediate step to file.
save_results : True
# Force redo of steps which have already been completed.
force_redo : False
# Integrations of ingress and/or egress.
baseline_ints : [50, -50]
# If True, make diagnostic plots.
do_plots : False
# ========================= END DMS CONFIG FILE =============================